DROP TABLE IF EXISTS PACIENTE CASCADE;
DROP TABLE IF EXISTS HISTORIAL CASCADE;
DROP TABLE IF EXISTS CITA CASCADE;
DROP TABLE IF EXISTS MEDICO CASCADE;
DROP TABLE IF EXISTS MEDICOCITA CASCADE;
DROP TABLE IF EXISTS ENFERMERO CASCADE;
DROP TABLE IF EXISTS ENFERMEROCITA CASCADE;
DROP TABLE IF EXISTS MEDICOESPECIALIDAD CASCADE;
DROP TABLE IF EXISTS JORNADA CASCADE;
DROP TABLE IF EXISTS CAUSA CASCADE;
DROP TABLE IF EXISTS PRESCRIPCION CASCADE;
DROP TABLE IF EXISTS ESPECIALIDAD CASCADE;
DROP TABLE IF EXISTS ESPECIALIDADCITA CASCADE;
DROP TABLE IF EXISTS VACUNA CASCADE;

CREATE TABLE PACIENTE (
ID INT NOT NULL,
DNI VARCHAR(255),
NOMBRE VARCHAR(255) NOT NULL,
APELLIDOS VARCHAR(255) NOT NULL,
CORREO VARCHAR(255),
TELEFONO INT,
NOMBRETUTOR VARCHAR(255),
DNITUTOR VARCHAR(255),
IDMEDICOCABECERA INT,
NACIMIENTO DATE NOT NULL,
CONSTRAINT PK_PACIENTE PRIMARY KEY (ID),
 
CREATE TABLE HISTORIAL (
IDHISTORIAL INT NOT NULL,
DNIPACIENTE VARCHAR(255) NOT NULL,
PRIMARY KEY (IDHISTORIAL),
CONSTRAINT FK_HISTORIAL_PACIENTE FOREIGN KEY (DNIPACIENTE) REFERENCES PACIENTE (DNI),
);

CREATE TABLE HISTORIAL (
IDHISTORIAL INT NOT NULL,
IDPACIENTE INT NOT NULL,
PRIMARY KEY (IDHISTORIAL),
CONSTRAINT FK_HISTORIAL_PACIENTE FOREIGN KEY (IDPACIENTE) REFERENCES PACIENTE (ID),
);

CREATE TABLE CITA (
IDCITA VARCHAR(255) NOT NULL,
IDPACIENTE INT NOT NULL,
IDHISTORIAL INT NOT NULL,
URGENTE BIT NOT NULL,
HORA_ENTRADA_ESTIMADA TIME ,
HORA_SALIDA_ESTIMADA TIME ,
PACIENTE_ACUDIDO VARCHAR(255) NOT NULL,
HORA_ENTRADA_REAL TIME,
HORA_SALIDA_REAL TIME,
FECHA DATE ,
CORREO_PACIENTE VARCHAR(255) NOT NULL,
TELEFONO_PACIENTE INT NOT NULL,
LUGAR_CITA VARCHAR(255) NOT NULL,
OTROS VARCHAR(255),
PRIORITARIO BIT,
CONFIRMADA BIT NOT NULL, 
CONSTRAINT PK_CITA PRIMARY KEY (IDCITA),
CONSTRAINT FK_CITA_HISTORIAL FOREIGN KEY (IDHISTORIAL) REFERENCES HISTORIAL (IDHISTORIAL),
CONSTRAINT FK_CITA_PACIENTE FOREIGN KEY (IDPACIENTE) REFERENCES PACIENTE (ID)
)

CREATE TABLE MEDICO(
 idmedico INT NOT NULL,
 nombre varchar(20) NOT NULL,
 apellidos varchar(20) NOT NULL,
 correo varchar(50) NOT NULL,
 PRIMARY KEY (idmedico));
 
 CREATE TABLE ENFERMERO(
 idenfermero INT NOT NULL,
 nombre varchar(20) NOT NULL,
 apellidos varchar(20) NOT NULL,
 correo varchar(50) NOT NULL,
 PRIMARY KEY (idenfermero));

CREATE TABLE MEDICOCITA(
IDCITA VARCHAR(255) NOT NULL,
idmedico INT NOT NULL,
CONSTRAINT PK_MEDICOCITA PRIMARY KEY (IDCITA,IDMEDICO),
CONSTRAINT FK_MEDICOCITA_CITA FOREIGN KEY (IDCITA) REFERENCES CITA (IDCITA),
CONSTRAINT FK_MEDICOCITA_MEDICO FOREIGN KEY (IDMEDICO) REFERENCES MEDICO (IDMEDICO)
)

CREATE TABLE JORNADA (
IDJORNADA INT NOT NULL,
IDMEDICO INT NOT NULL,
DIA VARCHAR(255) NOT NULL,
INICIO Timestamp NOT NULL,
FIN Timestamp NOT NULL,
CONSTRAINT PK_IDJORNADA PRIMARY KEY (IDJORNADA),
CONSTRAINT FK_IDMEDICO FOREIGN KEY (IDMEDICO) REFERENCES MEDICO (IDMEDICO)
)

CREATE TABLE CAUSA (
IDCAUSA INT NOT NULL,
TITULO VARCHAR(255) NOT NULL,
HORA_ASIGNACION TIME,
FECHA_ASIGNACION DATE,
IDCITA VARCHAR(255) NOT NULL,
CONSTRAINT PK_CAUSA PRIMARY KEY (IDCAUSA),
CONSTRAINT FK_CAUSA_CITA FOREIGN KEY (IDCITA) REFERENCES CITA (IDCITA)
)

CREATE TABLE PRESCRIPCION (
IDPRESCRIPCION INT NOT NULL,
TITULO VARCHAR(255) NOT NULL,
TIPO VARCHAR(255) NOT NULL,
CANTIDAD VARCHAR(255),
INTERVALO_DOSIS VARCHAR(255),
DURACION VARCHAR(255),
OBSERVACIONES VARCHAR(500),
HORA_ASIGNACION TIME,
FECHA_ASIGNACION DATE,
IDCITA VARCHAR(255) NOT NULL,
CONSTRAINT PK_PRESCRIPCION PRIMARY KEY (IDPRESCRIPCION),
CONSTRAINT FK_PRESCRIPCION_CITA FOREIGN KEY (IDCITA) REFERENCES CITA (IDCITA)
)

CREATE TABLE ESPECIALIDAD(
IDESPECIALIDAD VARCHAR(255) NOT NULL,
CONSTRAINT PK_IDESPECIALIDAD PRIMARY KEY (IDESPECIALIDAD),
)

CREATE TABLE MEDICOESPECIALIDAD(
IDESPECIALIDAD VARCHAR(255) NOT NULL,
idmedico INT NOT NULL,
CONSTRAINT PK_MEDICOESPECIALIDAD PRIMARY KEY (IDESPECIALIDAD,IDMEDICO),
CONSTRAINT FK_MEDICOESPECIALIDAD_ESPECIALIDAD FOREIGN KEY (IDESPECIALIDAD) REFERENCES ESPECIALIDAD (IDESPECIALIDAD),
CONSTRAINT FK_MEDICOESPECIALIDAD_MEDICO FOREIGN KEY (IDMEDICO) REFERENCES MEDICO (IDMEDICO)
)

CREATE TABLE ESPECIALIDADCITA(
IDCITA VARCHAR(255) NOT NULL,
IDESPECIALIDAD VARCHAR(255)NOT NULL,
NMEDICOS INT ,
CONSTRAINT PK_ESPECIALIDADCITA PRIMARY KEY (IDCITA,IDESPECIALIDAD),
CONSTRAINT FK_ESPECIALIDADCITA_CITA FOREIGN KEY (IDCITA) REFERENCES CITA (IDCITA),
CONSTRAINT FK_ESPECIALIDADCITA_ESPECIALIDAD FOREIGN KEY (IDESPECIALIDAD) REFERENCES ESPECIALIDAD (IDESPECIALIDAD)
)



CREATE TABLE ENFERMEROCITA(
IDCITA VARCHAR(255) NOT NULL,
IDENFERMERO INT NOT NULL,
NENFERMEROS INT ,
CONSTRAINT PK_ENFERMEROCITA PRIMARY KEY (IDCITA,IDENFERMERO),
CONSTRAINT FK_ENFERMEROCITA_CITA FOREIGN KEY (IDCITA) REFERENCES CITA (IDCITA),
CONSTRAINT FK_ENFERMEROCITA_ENFERMERO FOREIGN KEY (IDENFERMERO) REFERENCES ENFERMERO (IDENFERMERO)
)

CREATE TABLE VACUNA(
IDVACUNA INT NOT NULL,
IDHISTORIAL INT NOT NULL,
IDCITA VARCHAR(255),
FECHAREAL DATE,
FECHAAPROXIMADA DATE NOT NULL,
HORA TIME,
DOSIS VARCHAR(255),
REFUERZO BIT,
CONSTRAINT PK_VACUNA PRIMARY KEY (IDVACUNA),
CONSTRAINT FK_VACUNA_HISTORIAL FOREIGN KEY (IDHISTORIAL) REFERENCES HISTORIAL (IDHISTORIAL),
CONSTRAINT KF_VACUNA_CITA FOREIGN KEY (IDCITA) REFERENCES CITA (IDCITA)
)

INSERT INTO PACIENTE values ('1', '560483D', 'Jesus', 'Martin', 'jesus@martin.es', 666432, null, null, null, '2000-12-12')
INSERT INTO PACIENTE values ('2', '535732D', 'Marta', 'Martin', 'marta@martin.es', 357522, null, null, null, '2000-12-12')
INSERT INTO PACIENTE values ('3', null, 'Marta', 'Martin', null, null, 'Jose Manuel Rico', '555412D', null, '2000-12-12')

INSERT INTO HISTORIAL values (1, '1')
INSERT INTO HISTORIAL values (2, '2')

INSERT INTO CITA values ('1', '1', 1, 0, '12:30:00', '13:00:00', 'Asistencia Sin Asignar', null, null, '2022-11-14', 'jesus@martin.es', 666432,'consulta_1','',0,1)
INSERT INTO CITA values ('2', '2', 2, 0, '12:30:00', '13:00:00', 'Asistencia Sin Asignar', null, null, '2022-11-17', 'marta@martin.es', 357522,'consulta_1','',0,1)
INSERT INTO CITA values ('3', '2', 2, 0, '12:30:00', '13:00:00', 'Asistencia Sin Asignar', null, null, '2022-11-17', 'marta@martin.es', 357522,'consulta_1','',0,0)

INSERT INTO CAUSA values (1, 'Vomitos', '12:36:56', '2022-11-14', '1')
INSERT INTO CAUSA VALUES(2, 'Dolor inguinal', '13:45:33', '2022-11-17', '2')

INSERT INTO PRESCRIPCION values (1, 'Vendaje', 'Tratamiento', null, null, null, '', '12:36:56', '2022-11-14', '1')
INSERT INTO MEDICO values (1, 'Julia', 'Lopez', 'lopezjulia@gmail.com')
INSERT INTO medico (idmedico,nombre,apellidos,correo) VALUES (12,'Felipe','Garcia Gomez','felipegarciagomez5@gmail.com');
INSERT INTO medico (idmedico,nombre,apellidos,correo) VALUES (13,'Diego','Martínez Menéndez ','felipegarciagomez5@gmail.com');
INSERT INTO medico (idmedico,nombre,apellidos,correo) VALUES (14,'Sergio' ,'Mate Suarez','felipegarciagomez5@gmail.com');


INSERT INTO enfermero (idenfermero,nombre,apellidos,correo) VALUES (1,'Enfermero','','enfer@mero.com');
INSERT INTO enfermero (idenfermero,nombre,apellidos,correo) VALUES (2,'Felipe','Garcia Gomez','felipegarciagomez5@gmail.com');

INSERT INTO "PUBLIC"."ESPECIALIDAD" ( "IDESPECIALIDAD" ) VALUES ( 'Traumatologia');
INSERT INTO "PUBLIC"."ESPECIALIDAD" ( "IDESPECIALIDAD" ) VALUES ( 'Primaria');
INSERT INTO "PUBLIC"."ESPECIALIDAD" ( "IDESPECIALIDAD" ) VALUES ( 'Cardiologia');

INSERT INTO "PUBLIC"."MEDICOESPECIALIDAD" ( "IDESPECIALIDAD", "IDMEDICO" ) VALUES ( 'Cardiologia',12 )
INSERT INTO "PUBLIC"."MEDICOESPECIALIDAD" ( "IDESPECIALIDAD", "IDMEDICO" ) VALUES ( 'Traumatologia',13 )

INSERT INTO VACUNA values (1, 1, null, null, '2023-04-13', null, 'Tetanos', 0)

